(function(f,S){typeof exports=="object"&&typeof module<"u"?module.exports=S(require("vue")):typeof define=="function"&&define.amd?define(["vue"],S):(f=typeof globalThis<"u"?globalThis:f||self,f.VueForm=S(f.Vue))})(this,function(f){"use strict";const S={componentPrefix:"V",errorAdapter:t=>t};var Zt=typeof global=="object"&&global&&global.Object===Object&&global;const k=Zt;var Qt=typeof self=="object"&&self&&self.Object===Object&&self,kt=k||Qt||Function("return this")();const p=kt;var te=p.Symbol;const m=te;var tt=Object.prototype,ee=tt.hasOwnProperty,re=tt.toString,w=m?m.toStringTag:void 0;function ne(t){var e=ee.call(t,w),r=t[w];try{t[w]=void 0;var n=!0}catch{}var s=re.call(t);return n&&(e?t[w]=r:delete t[w]),s}var ie=Object.prototype,ae=ie.toString;function oe(t){return ae.call(t)}var se="[object Null]",ce="[object Undefined]",et=m?m.toStringTag:void 0;function E(t){return t==null?t===void 0?ce:se:et&&et in Object(t)?ne(t):oe(t)}function I(t){return t!=null&&typeof t=="object"}var ue=Array.isArray;const B=ue;function P(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var fe="[object AsyncFunction]",le="[object Function]",he="[object GeneratorFunction]",pe="[object Proxy]";function rt(t){if(!P(t))return!1;var e=E(t);return e==le||e==he||e==fe||e==pe}var de=p["__core-js_shared__"];const N=de;var nt=function(){var t=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ge(t){return!!nt&&nt in t}var ye=Function.prototype,be=ye.toString;function y(t){if(t!=null){try{return be.call(t)}catch{}try{return t+""}catch{}}return""}var ve=/[\\^$.*+?()[\]{}|]/g,_e=/^\[object .+?Constructor\]$/,$e=Function.prototype,me=Object.prototype,Te=$e.toString,je=me.hasOwnProperty,Ae=RegExp("^"+Te.call(je).replace(ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oe(t){if(!P(t)||ge(t))return!1;var e=rt(t)?Ae:_e;return e.test(y(t))}function Se(t,e){return t==null?void 0:t[e]}function b(t,e){var r=Se(t,e);return Oe(r)?r:void 0}var we=b(p,"WeakMap");const U=we;var it=Object.create,Ee=function(){function t(){}return function(e){if(!P(e))return{};if(it)return it(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const Ie=Ee;function Pe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var xe=function(){try{var t=b(Object,"defineProperty");return t({},"",{}),t}catch{}}();const at=xe;function Ce(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Fe=9007199254740991,Me=/^(?:0|[1-9]\d*)$/;function De(t,e){var r=typeof t;return e=e??Fe,!!e&&(r=="number"||r!="symbol"&&Me.test(t))&&t>-1&&t%1==0&&t<e}function ot(t,e,r){e=="__proto__"&&at?at(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function st(t,e){return t===e||t!==t&&e!==e}var Ge=Object.prototype,Le=Ge.hasOwnProperty;function ct(t,e,r){var n=t[e];(!(Le.call(t,e)&&st(n,r))||r===void 0&&!(e in t))&&ot(t,e,r)}function M(t,e,r,n){var s=!r;r||(r={});for(var c=-1,o=e.length;++c<o;){var u=e[c],l=n?n(r[u],t[u],u,r,t):void 0;l===void 0&&(l=t[u]),s?ot(r,u,l):ct(r,u,l)}return r}var Be=9007199254740991;function ut(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Be}function ft(t){return t!=null&&ut(t.length)&&!rt(t)}var Ne=Object.prototype;function z(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Ne;return t===r}function Ue(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var ze="[object Arguments]";function lt(t){return I(t)&&E(t)==ze}var ht=Object.prototype,Ve=ht.hasOwnProperty,Re=ht.propertyIsEnumerable,Ke=lt(function(){return arguments}())?lt:function(t){return I(t)&&Ve.call(t,"callee")&&!Re.call(t,"callee")};const He=Ke;function We(){return!1}var pt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,dt=pt&&typeof module=="object"&&module&&!module.nodeType&&module,qe=dt&&dt.exports===pt,gt=qe?p.Buffer:void 0,Ye=gt?gt.isBuffer:void 0,Je=Ye||We;const yt=Je;var Xe="[object Arguments]",Ze="[object Array]",Qe="[object Boolean]",ke="[object Date]",tr="[object Error]",er="[object Function]",rr="[object Map]",nr="[object Number]",ir="[object Object]",ar="[object RegExp]",or="[object Set]",sr="[object String]",cr="[object WeakMap]",ur="[object ArrayBuffer]",fr="[object DataView]",lr="[object Float32Array]",hr="[object Float64Array]",pr="[object Int8Array]",dr="[object Int16Array]",gr="[object Int32Array]",yr="[object Uint8Array]",br="[object Uint8ClampedArray]",vr="[object Uint16Array]",_r="[object Uint32Array]",a={};a[lr]=a[hr]=a[pr]=a[dr]=a[gr]=a[yr]=a[br]=a[vr]=a[_r]=!0,a[Xe]=a[Ze]=a[ur]=a[Qe]=a[fr]=a[ke]=a[tr]=a[er]=a[rr]=a[nr]=a[ir]=a[ar]=a[or]=a[sr]=a[cr]=!1;function $r(t){return I(t)&&ut(t.length)&&!!a[E(t)]}function V(t){return function(e){return t(e)}}var bt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,x=bt&&typeof module=="object"&&module&&!module.nodeType&&module,mr=x&&x.exports===bt,R=mr&&k.process,Tr=function(){try{var t=x&&x.require&&x.require("util").types;return t||R&&R.binding&&R.binding("util")}catch{}}();const T=Tr;var vt=T&&T.isTypedArray,jr=vt?V(vt):$r;const Ar=jr;var Or=Object.prototype,Sr=Or.hasOwnProperty;function _t(t,e){var r=B(t),n=!r&&He(t),s=!r&&!n&&yt(t),c=!r&&!n&&!s&&Ar(t),o=r||n||s||c,u=o?Ue(t.length,String):[],l=u.length;for(var h in t)(e||Sr.call(t,h))&&!(o&&(h=="length"||s&&(h=="offset"||h=="parent")||c&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||De(h,l)))&&u.push(h);return u}function $t(t,e){return function(r){return t(e(r))}}var wr=$t(Object.keys,Object);const Er=wr;var Ir=Object.prototype,Pr=Ir.hasOwnProperty;function xr(t){if(!z(t))return Er(t);var e=[];for(var r in Object(t))Pr.call(t,r)&&r!="constructor"&&e.push(r);return e}function K(t){return ft(t)?_t(t):xr(t)}function Cr(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Fr=Object.prototype,Mr=Fr.hasOwnProperty;function Dr(t){if(!P(t))return Cr(t);var e=z(t),r=[];for(var n in t)n=="constructor"&&(e||!Mr.call(t,n))||r.push(n);return r}function H(t){return ft(t)?_t(t,!0):Dr(t)}var Gr=b(Object,"create");const C=Gr;function Lr(){this.__data__=C?C(null):{},this.size=0}function Br(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Nr="__lodash_hash_undefined__",Ur=Object.prototype,zr=Ur.hasOwnProperty;function Vr(t){var e=this.__data__;if(C){var r=e[t];return r===Nr?void 0:r}return zr.call(e,t)?e[t]:void 0}var Rr=Object.prototype,Kr=Rr.hasOwnProperty;function Hr(t){var e=this.__data__;return C?e[t]!==void 0:Kr.call(e,t)}var Wr="__lodash_hash_undefined__";function qr(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=C&&e===void 0?Wr:e,this}function v(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}v.prototype.clear=Lr,v.prototype.delete=Br,v.prototype.get=Vr,v.prototype.has=Hr,v.prototype.set=qr;function Yr(){this.__data__=[],this.size=0}function D(t,e){for(var r=t.length;r--;)if(st(t[r][0],e))return r;return-1}var Jr=Array.prototype,Xr=Jr.splice;function Zr(t){var e=this.__data__,r=D(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Xr.call(e,r,1),--this.size,!0}function Qr(t){var e=this.__data__,r=D(e,t);return r<0?void 0:e[r][1]}function kr(t){return D(this.__data__,t)>-1}function tn(t,e){var r=this.__data__,n=D(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function d(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}d.prototype.clear=Yr,d.prototype.delete=Zr,d.prototype.get=Qr,d.prototype.has=kr,d.prototype.set=tn;var en=b(p,"Map");const F=en;function rn(){this.size=0,this.__data__={hash:new v,map:new(F||d),string:new v}}function nn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function G(t,e){var r=t.__data__;return nn(e)?r[typeof e=="string"?"string":"hash"]:r.map}function an(t){var e=G(this,t).delete(t);return this.size-=e?1:0,e}function on(t){return G(this,t).get(t)}function sn(t){return G(this,t).has(t)}function cn(t,e){var r=G(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function j(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}j.prototype.clear=rn,j.prototype.delete=an,j.prototype.get=on,j.prototype.has=sn,j.prototype.set=cn;function mt(t,e){for(var r=-1,n=e.length,s=t.length;++r<n;)t[s+r]=e[r];return t}var un=$t(Object.getPrototypeOf,Object);const Tt=un;function fn(){this.__data__=new d,this.size=0}function ln(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function hn(t){return this.__data__.get(t)}function pn(t){return this.__data__.has(t)}var dn=200;function gn(t,e){var r=this.__data__;if(r instanceof d){var n=r.__data__;if(!F||n.length<dn-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new j(n)}return r.set(t,e),this.size=r.size,this}function A(t){var e=this.__data__=new d(t);this.size=e.size}A.prototype.clear=fn,A.prototype.delete=ln,A.prototype.get=hn,A.prototype.has=pn,A.prototype.set=gn;function yn(t,e){return t&&M(e,K(e),t)}function bn(t,e){return t&&M(e,H(e),t)}var jt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,At=jt&&typeof module=="object"&&module&&!module.nodeType&&module,vn=At&&At.exports===jt,Ot=vn?p.Buffer:void 0,St=Ot?Ot.allocUnsafe:void 0;function _n(t,e){if(e)return t.slice();var r=t.length,n=St?St(r):new t.constructor(r);return t.copy(n),n}function $n(t,e){for(var r=-1,n=t==null?0:t.length,s=0,c=[];++r<n;){var o=t[r];e(o,r,t)&&(c[s++]=o)}return c}function wt(){return[]}var mn=Object.prototype,Tn=mn.propertyIsEnumerable,Et=Object.getOwnPropertySymbols,jn=Et?function(t){return t==null?[]:(t=Object(t),$n(Et(t),function(e){return Tn.call(t,e)}))}:wt;const W=jn;function An(t,e){return M(t,W(t),e)}var On=Object.getOwnPropertySymbols,Sn=On?function(t){for(var e=[];t;)mt(e,W(t)),t=Tt(t);return e}:wt;const It=Sn;function wn(t,e){return M(t,It(t),e)}function Pt(t,e,r){var n=e(t);return B(t)?n:mt(n,r(t))}function En(t){return Pt(t,K,W)}function In(t){return Pt(t,H,It)}var Pn=b(p,"DataView");const q=Pn;var xn=b(p,"Promise");const Y=xn;var Cn=b(p,"Set");const J=Cn;var xt="[object Map]",Fn="[object Object]",Ct="[object Promise]",Ft="[object Set]",Mt="[object WeakMap]",Dt="[object DataView]",Mn=y(q),Dn=y(F),Gn=y(Y),Ln=y(J),Bn=y(U),_=E;(q&&_(new q(new ArrayBuffer(1)))!=Dt||F&&_(new F)!=xt||Y&&_(Y.resolve())!=Ct||J&&_(new J)!=Ft||U&&_(new U)!=Mt)&&(_=function(t){var e=E(t),r=e==Fn?t.constructor:void 0,n=r?y(r):"";if(n)switch(n){case Mn:return Dt;case Dn:return xt;case Gn:return Ct;case Ln:return Ft;case Bn:return Mt}return e});const X=_;var Nn=Object.prototype,Un=Nn.hasOwnProperty;function zn(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Un.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Vn=p.Uint8Array;const Gt=Vn;function Z(t){var e=new t.constructor(t.byteLength);return new Gt(e).set(new Gt(t)),e}function Rn(t,e){var r=e?Z(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Kn=/\w*$/;function Hn(t){var e=new t.constructor(t.source,Kn.exec(t));return e.lastIndex=t.lastIndex,e}var Lt=m?m.prototype:void 0,Bt=Lt?Lt.valueOf:void 0;function Wn(t){return Bt?Object(Bt.call(t)):{}}function qn(t,e){var r=e?Z(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Yn="[object Boolean]",Jn="[object Date]",Xn="[object Map]",Zn="[object Number]",Qn="[object RegExp]",kn="[object Set]",ti="[object String]",ei="[object Symbol]",ri="[object ArrayBuffer]",ni="[object DataView]",ii="[object Float32Array]",ai="[object Float64Array]",oi="[object Int8Array]",si="[object Int16Array]",ci="[object Int32Array]",ui="[object Uint8Array]",fi="[object Uint8ClampedArray]",li="[object Uint16Array]",hi="[object Uint32Array]";function pi(t,e,r){var n=t.constructor;switch(e){case ri:return Z(t);case Yn:case Jn:return new n(+t);case ni:return Rn(t,r);case ii:case ai:case oi:case si:case ci:case ui:case fi:case li:case hi:return qn(t,r);case Xn:return new n;case Zn:case ti:return new n(t);case Qn:return Hn(t);case kn:return new n;case ei:return Wn(t)}}function di(t){return typeof t.constructor=="function"&&!z(t)?Ie(Tt(t)):{}}var gi="[object Map]";function yi(t){return I(t)&&X(t)==gi}var Nt=T&&T.isMap,bi=Nt?V(Nt):yi;const vi=bi;var _i="[object Set]";function $i(t){return I(t)&&X(t)==_i}var Ut=T&&T.isSet,mi=Ut?V(Ut):$i;const Ti=mi;var ji=1,Ai=2,Oi=4,zt="[object Arguments]",Si="[object Array]",wi="[object Boolean]",Ei="[object Date]",Ii="[object Error]",Vt="[object Function]",Pi="[object GeneratorFunction]",xi="[object Map]",Ci="[object Number]",Rt="[object Object]",Fi="[object RegExp]",Mi="[object Set]",Di="[object String]",Gi="[object Symbol]",Li="[object WeakMap]",Bi="[object ArrayBuffer]",Ni="[object DataView]",Ui="[object Float32Array]",zi="[object Float64Array]",Vi="[object Int8Array]",Ri="[object Int16Array]",Ki="[object Int32Array]",Hi="[object Uint8Array]",Wi="[object Uint8ClampedArray]",qi="[object Uint16Array]",Yi="[object Uint32Array]",i={};i[zt]=i[Si]=i[Bi]=i[Ni]=i[wi]=i[Ei]=i[Ui]=i[zi]=i[Vi]=i[Ri]=i[Ki]=i[xi]=i[Ci]=i[Rt]=i[Fi]=i[Mi]=i[Di]=i[Gi]=i[Hi]=i[Wi]=i[qi]=i[Yi]=!0,i[Ii]=i[Vt]=i[Li]=!1;function L(t,e,r,n,s,c){var o,u=e&ji,l=e&Ai,h=e&Oi;if(r&&(o=s?r(t,n,s,c):r(t)),o!==void 0)return o;if(!P(t))return t;var qt=B(t);if(qt){if(o=zn(t),!u)return Pe(t,o)}else{var O=X(t),Yt=O==Vt||O==Pi;if(yt(t))return _n(t,u);if(O==Rt||O==zt||Yt&&!s){if(o=l||Yt?{}:di(t),!u)return l?wn(t,bn(o,t)):An(t,yn(o,t))}else{if(!i[O])return s?t:{};o=pi(t,O,u)}}c||(c=new A);var Jt=c.get(t);if(Jt)return Jt;c.set(t,o),Ti(t)?t.forEach(function(g){o.add(L(g,e,r,g,t,c))}):vi(t)&&t.forEach(function(g,$){o.set($,L(g,e,r,$,t,c))});var ra=h?l?In:En:l?H:K,Xt=qt?void 0:ra(t);return Ce(Xt||t,function(g,$){Xt&&($=g,g=t[$]),ct(o,$,L(g,e,r,$,t,c))}),o}var Ji=1,Xi=4;function Q(t){return L(t,Ji|Xi)}const Kt=(t,e)=>{console.warn("[vue-list] "+t+":"+e)},Zi=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},Ht={name:null,value:null,type:null,in:t=>t,out:t=>t},Qi={props:{fields:{type:Array,required:!0},id:{type:[String,Number]},nativeId:String,get:{type:Function},save:{type:Function},delete:{type:Function},archive:{type:Function},formState:{type:Object},formValues:{type:Object}},data(){return{state:null,isGetting:!1,isSaving:!1,isDeleting:!1,isArchiving:!1,isArchived:!1,errors:{},error:null}},mounted(){this.init()},computed:{serializedFields(){return this.fields.map((t,e)=>{const r=typeof t;return r==="string"?{...Ht,name:t,value:null}:r==="object"&&!Array.isArray(t)?{...Ht,...t}:(Kt("Invalid field config provided at index",e),null)}).filter(t=>t)},fieldErrors(){return Object.keys(this.errors).filter(t=>this.hasField(t)).reduce((t,e)=>(t[e]=this.errors[e],t),{})},nonFieldErrors(){return Object.keys(this.errors).filter(t=>!this.hasField(t)).reduce((t,e)=>(t[e]=this.errors[e],t),{})},values(){const t={};return this.serializedFields.forEach(e=>{t[e.name]=e.out(this.state[e.name])}),t},mode(){return this.id==null?"create":"edit"},isCreating(){return this.mode==="create"},isEditing(){return this.mode==="edit"},isLoading(){return this.isGetting||this.isSaving||this.isDeleting},scopes(){return{mode:this.mode,isCreating:this.isCreating,isEditing:this.isEditing,state:this.state,values:this.values,getItem:this.getItem,saveItem:this.saveItem,deleteItem:this.deleteItem,archiveItem:this.archiveItem,setValue:this.setValue,reset:this.reset,isSaving:this.isSaving,isGetting:this.isGetting,isDeleting:this.isDeleting,isArchiving:this.isArchiving,isLoading:this.isLoading,isArchived:this.isArchived,errors:this.errors||{},error:this.error,hasError:this.hasError,fieldErrors:this.fieldErrors,nonFieldErrors:this.nonFieldErrors}},hasError(){return this.error||Object.keys(this.errors).length>0}},methods:{init(){this.setState(),this.isEditing&&this.getItem()},reset(){this.setState(),this.setErrors()},hasField(t){return this.serializedFields.find(e=>e.name===t)},setState(t={}){const e={};this.serializedFields.forEach(r=>{let n;Object.prototype.hasOwnProperty.call(t,r.name)?n=t[r.name]:n=r.value,e[r.name]=r.in(n),e[r.name]=r.out(n)}),this.state=e,this.$emit("update:formState",this.state),this.$emit("update:formValues",this.values)},async getItem(){return this.isGetting=!0,this.setErrors(),this.get(this.id).then(t=>(this.validateIn(t)&&(t.archivedAt?this.isArchived=!0:this.isArchived=!1,this.setState(t)),t)).catch(t=>{this.setErrors(t)}).finally(()=>{this.isGetting=!1})},async saveItem(){return this.isSaving=!0,this.setErrors(),this.save(this.id,Q(this.values)).then(t=>(this.validateIn(t)&&this.setState(t),t)).catch(t=>{this.setErrors(t)}).finally(()=>{this.isSaving=!1})},async deleteItem(){return this.isDeleting=!0,this.setErrors(),this.delete(this.id,Q(this.values)).catch(t=>{this.setErrors(t)}).finally(()=>{this.isDeleting=!1})},async archiveItem(){return this.isArchiving=!0,this.setErrors(),this.archive(this.id,Q(this.values)).catch(t=>{this.setErrors(t)}).finally(()=>{this.isArchiving=!1})},setValue(t,e){this.state[t]=e},setErrors(t){if(t){const{fields:e,message:r}=this.OPTIONS.errorAdapter(t);(e||r)&&(this.errors=e,this.error=r,Object.keys(e).length>0&&console.error(r,e))}else this.errors={},this.error=null},validateIn(t){return typeof t!="object"||Array.isArray(t)?(Kt("Invalid input/errors received",t),!1):!0}}},ki=["id"];function ta(t,e,r,n,s,c){return f.openBlock(),f.createElementBlock("div",{id:r.nativeId},[s.state?f.renderSlot(t.$slots,"default",f.normalizeProps(f.mergeProps({key:0},c.scopes))):f.createCommentVNode("",!0)],8,ki)}const ea=Zi(Qi,[["render",ta]]),Wt={install:(t,e={})=>{const r=Object.assign({},S,e),n=r.componentPrefix;t.component(`${n}Form`,{data(){return{OPTIONS:r}},provide:{OPTIONS:r},extends:ea})}};return typeof window<"u"&&window.Vue&&window.Vue.use(Wt),Wt});
